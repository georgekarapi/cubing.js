import{a as g}from"./chunk-VEMOVSEF.js";import{c as m,e as L}from"./chunk-4KNYPLKC.js";import{m as u}from"./chunk-MQN5DVPY.js";import{e as d}from"./chunk-S4ZNJEAB.js";import{j as h,q as v}from"./chunk-K5RKCHW3.js";var T="transparent-grid",n={"3x3x3":[["","U'","U2'","L","l","u'","L2","M2","/enter"],["U","","U'","B","x'","B'","B2","x2'","B2'"],["U2","U","","u","r'","R'","/backspace","M2","R2'"],["L'","B'","u'","","y'","y2'","F'","M","F2"],["l'","x","r","y","","y'","d'","x'","d"],["u","B","R","y2","y","","F2'","M","F"],["L2'","B2'","z","F","d","F2","","D","D2"],["M2'","x2","M2'","M'","x","M'","D'","","D"],["/space","B2","R2","F2'","d'","F'","D2'","D'",""]],"2x2x2":[["","U'","U2'","L","l","u'","L2","M2","/enter"],["U","","U'","B","x'","B'","B2","x2'","B2'"],["U2","U","","u","r'","R'","z'","M2","R2'"],["L'","B'","u'","","y'","y2'","F'","M","F2"],["l'","x","r","y","","y'","d'","x'","d"],["u","B","R","y2","y","","F2'","M","F"],["L2'","B2'","z","F","d","F2","","D","D2"],["M2'","x2","M2'","M'","x","M'","D'","","D"],["/space","B2","R2","F2'","d'","F'","D2'","D'",""]],"4x4x4":[["","U'","U2'","L","l","u'","L2","2L2","/enter"],["U","","U'","B","Rv'","B'","B2","Rv2'","B2'"],["U2","U","","u","r'","R'","Fv'","2R2'","R2'"],["L'","B'","u'","","Uv'","Uv2'","F'","2L","F2"],["l'","Rv","r","Uv","","Uv'","d'","Lv","d"],["u","B","R","Uv2","Uv","","F2'","2R'","F"],["L2'","B2'","Fv","F","d","F2","","D","D2"],["2L2'","Rv2","2R2","2L'","Lv'","2R","D'","","D"],["/space","B2","R2","F2'","d'","F'","D2'","D'",""]],"5x5x5":[["","U'","U2'","L","l","u'","L2","2L2","/enter"],["U","","U'","B","Rv'","B'","B2","Rv2'","B2'"],["U2","U","","u","r'","R'","Fv'","2R2'","R2'"],["L'","B'","u'","","Uv'","Uv2'","F'","2L","F2"],["l'","Rv","r","Uv","","Uv'","d'","Lv","d"],["u","B","R","Uv2","Uv","","F2'","2R'","F"],["L2'","B2'","Fv","F","d","F2","","D","D2"],["2L2'","Rv2","2R2","2L'","Lv'","2R","D'","","D"],["/space","B2","R2","F2'","d'","F'","D2'","D'",""]],fto:[["","U'","U2'","L","l","u'","L2","2L2","/enter"],["U","","U'","BL","Rv'","BR'","BL2","Rv2'","BR2'"],["U2","U","","u","r'","R'","Fv'","2R2'","R2'"],["L'","BL'","u'","","Uv'","Uv2'","F'","2L","F2"],["l'","Rv","r","Uv","","Uv'","d'","Lv","d"],["u","BR","R","Uv2","Uv","","F2'","2R'","F"],["L2'","BL2'","Fv","F","d","F2","","D","D"],["2L2'","Rv2","2R2","2L'","Lv'","2R","D'","","D"],["/space","BR2","R2","F2'","d'","F'","D'","D'",""]],megaminx:[["","U'","U2'","L","dl","u'","L2","","/enter"],["U","","U'","BL","Rv'","BR'","BL2","Rv2'","BR2'"],["U2","U","","u","dr'","R'","Fv'","","R2'"],["L'","BL'","u'","","Uv'","Uv2'","F'","2L","F2"],["dl'","Rv","dr","Uv","","Uv'","d'","Lv","d"],["u","BR","R","Uv2","Uv","","F2'","2R'","F"],["L2'","BL2'","Fv","F","d","F2","","FL","D"],["","Rv2","","2L'","Lv'","2R","FL'","","FR"],["/space","BR2","R2","F2'","d'","F'","D'","FR'",""]]};function R(o){return{space:"\u23EE",enter:"\u25B6\uFE0F",backspace:"\u20D4"}[o]}function U(o){let a={alg:new v,puzzle:o,controlPanel:"none",background:"none",experimentalSetupAlg:m()},e=new URL(document.location.href).searchParams.get("back-view");return e&&(a.backView=e),new u(a)}var l=class extends HTMLElement{constructor(e,i,t){super();this.puzzleName=e;this.actionListener=i;this.algListener=t;this.twistyPlayer=U(e);let s=new URL(document.location.href).searchParams.get("theme");f.includes(s)||(s=T),this.theme=s,console.log("Using theme:",this.theme)}setActionListener(e){this.actionListener=e}setAlgListener(e){this.algListener=e}connectedCallback(){this.appendChild(this.twistyPlayer),this.twistyPlayer.tempoScale=3,this.puzzleName!=="3x3x3"&&setTimeout(async()=>{let e=await this.twistyPlayer.experimentalScreenshot();console.log("Setting touch icon from canvas."),document.querySelector('link[rel="apple-touch-icon"]').href=e},100)}showGrid(){let e=new r(this.puzzleName,this.onAlgLeaf.bind(this),i=>this.actionListener(i),this.theme==="grid-back"?"blank":this.theme,!0);if(this.appendChild(e),this.theme==="transparent-grid"||this.theme==="grid-back"){let i=new r(this.puzzleName,this.onAlgLeaf.bind(this),t=>this.actionListener(t),"transparent-grid-back",!1);this.prepend(i)}}onAlgLeaf(e){this.addAlgLeaf(e),this.algListener()}addAlgLeaf(e){try{this.twistyPlayer.experimentalAddAlgLeaf(e,{cancel:{directional:L()?"any-direction":"none",puzzleSpecificModWrap:"gravity"},puzzleSpecificSimplifyOptions:d[this.puzzleName]?.puzzleSpecificSimplifyOptions})}catch{console.warn("Invalid alg leaf")}}};customElements&&customElements.define("swipey-puzzle",l);var f=["blank","grid","grid-back","transparent-grid","transparent-grid-back","HUD","box","layers","dots","cross-hairs"],r=class extends HTMLElement{constructor(e,i,t,s,F=!1){super();this.puzzleName=e;this.moveListener=i;this.actionListener=t;this.theme=s;this.sectorMap=new Map;this.swipeSource=null;this.showAllTargetMovesID=0;this.sectors=[];for(let c=0;c<9;c++){let p=document.createElement("div");this.sectors.push(p),this.sectorMap.set(p,c)}this.swipeTracker=new g(this.sectors,this.onTouchChange.bind(this),this.onSwipeFinish.bind(this)),this.classList.add(`theme-${this.theme}`)}connectedCallback(){for(let e of this.sectors)this.appendChild(e)}onTouchChange(e){let i=new Map;for(let t of this.sectors)i.set(t,{isSource:!1,isTentativeTarget:!1,isSelfRetarget:!1,text:"",hasMoved:!1});for(let t of e){let s=i.get(t.sourceSector);s.isSource=!0,s.text=this.moveUIText(n[this.puzzleName][this.sectorMap.get(t.sourceSector)][this.sectorMap.get(t.currentSector)]),s.hasMoved=s.hasMoved||t.hasMovedAwayFromSourceSector,i.get(t.currentSector).isTentativeTarget=!0,s.isSelfRetarget=s.isSelfRetarget||t.hasMovedAwayFromSourceSector&&t.sourceSector===t.currentSector}for(let[t,s]of i.entries())t.classList.toggle("source",s.isSource),t.classList.toggle("tentative-target",s.isTentativeTarget),t.classList.toggle("self-retarget",s.isSelfRetarget),t.textContent=s.text;e.length===1&&!e[0].hasMovedAwayFromSourceSector?(this.showAllTargetMovesID++,this.showAllTargetMoves(e[0])):this.classList.remove("showing-all-targets")}onSwipeFinish(e,i){this.hideAllTargetMoves();let t=n[this.puzzleName][this.sectorMap.get(e)][this.sectorMap.get(i)];t===""||(t.startsWith("/")?(this.actionListener(t.slice(1)),t==="space"&&this.swipeTracker.reset()):this.moveListener(new h(t)))}showAllTargetMoves(e){this.showAllTargetMovesID++;let i=this.showAllTargetMovesID;setTimeout(()=>{if(!(this.showAllTargetMovesID!==i||!this.swipeTracker.isSwipeStillActive(e)||e.hasMovedAwayFromSourceSector)){for(let t=0;t<this.sectors.length;t++){let s=this.sectors[t];s!==e.sourceSector&&(s.textContent=this.moveUIText(n[this.puzzleName][this.sectorMap.get(e.sourceSector)][t]))}this.classList.add("showing-all-targets")}},500)}hideAllTargetMoves(){this.showAllTargetMovesID++,this.classList.remove("showing-all-targets");for(let e of this.sectorMap.keys())e!==this.swipeSource&&(e.textContent="")}moveUIText(e){return e.startsWith("/")?R(e.slice(1)):e}};customElements&&customElements.define("swipe-grid",r);export{f as a,r as b,n as c,R as d,l as e};
//# sourceMappingURL=chunk-XXHMF4PA.js.map
