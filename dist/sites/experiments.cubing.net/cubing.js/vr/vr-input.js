import{d as c,h as u,n as o,o as d,t as b,u as p}from"../chunk-UW55Z7GB.js";import"../chunk-SYRP7SJ5.js";var L=(t=>(t[t.Untargeted=0]="Untargeted",t[t.Targeted=1]="Targeted",t[t.Pressed=2]="Pressed",t))(L||{}),f=2,m=(r=>(r[r.Trackpad=0]="Trackpad",r[r.Trigger=1]="Trigger",r[r.Grip=2]="Grip",r[r.XorA=3]="XorA",r[r.YorB=4]="YorB",r))(m||{}),a=new u(0,0,-1),l=new d;l.setAttribute("position",new o([0,0,0,a.x,a.y,a.z],3));l.setAttribute("color",new o([.5,.5,.5,0,0,0],3));var B=new b({blending:c,linewidth:10,transparent:!0,opacity:.5}),k=(i=>(i.All="all",i.Any="any",i.Single="single",i.None="none",i))(k||{}),s=class{constructor(n,e,t,i,r){this.grouping=n;this.buttonSpecs=e;this.activatedCallback=t;this.continuedActiveCallback=i;this.deactivatedCallback=r;this.activeLastTime=!1}update(n){let e=this.currentlyActive(n);e&&(this.activeLastTime?this.continuedActiveCallback&&this.continuedActiveCallback():this.activatedCallback()),this.activeLastTime&&!e&&this.deactivatedCallback&&this.deactivatedCallback(),this.activeLastTime=e}currentlyActive(n){switch(this.grouping){case"all":return this.numberPressed(n)===this.buttonSpecs.length;case"any":return this.numberPressed(n,!0)>0;case"single":return this.numberPressed(n)===1;case"none":return this.numberPressed(n,!0)===0;default:throw new Error("Unknown grouping")}}numberPressed(n,e=!1){let t=0;for(let i of this.buttonSpecs)if(this.isButtonPressed(n,i)){if(e)return 1;t++}return t}isButtonPressed(n,e){let t=n[e.controllerIdx]||[];return!e.invert==!!t[e.buttonIdx]}},v=class{constructor(n){this.controllers=[];this.buttonListeners=[];for(let e=0;e<f;e++){let t=n.xr.getController(e);t.add(new p(l,B)),this.controllers.push(t)}}update(){let n=navigator.getGamepads(),e={};for(let t=0;n.length;t++){let i=n[t]||{buttons:[]};e[t]=[];let r=i.buttons||[];for(let g of r)e[t].push(g.pressed)}for(let t of this.buttonListeners)t.update(e)}addButtonListener(n,e,t,i,r){this.buttonListeners.push(new s(n,e,t,i,r))}addSingleButtonListener(n,e,t,i){this.addButtonListener("all",[n],e,t,i)}};export{k as ButtonGrouping,m as OculusButton,L as Status,v as VRInput,a as controllerDirection};
//# sourceMappingURL=vr-input.js.map
